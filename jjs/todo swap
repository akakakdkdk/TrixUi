-- Perfect Swap Script com Auto-Delay Ragdoll
local RS = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")

-- ==================== CONFIGURA√á√ïES ====================
local CONFIG = {
    delayStanding = 0.5,  -- Delay quando em p√©
    delayRagdoll = 0.3,   -- Delay quando em ragdoll
    hotkey = Enum.KeyCode.E,
    targetMode = "dummy"
}

local player = Players.LocalPlayer
local isExecuting = false
local isLocked = false
local isDragging = false
local dragStart, startPos

-- ==================== DETECTAR PLATAFORMA ====================
local isMobile = false
local isPC = false

if UIS.TouchEnabled and not UIS.KeyboardEnabled and not UIS.MouseEnabled then
    isMobile = true
    isPC = false
elseif UIS.KeyboardEnabled or UIS.MouseEnabled then
    isPC = true
    isMobile = false
else
    -- Fallback - assume PC se n√£o detectar
    isPC = true
    isMobile = false
end

print("üì± Plataforma detectada: " .. (isMobile and "MOBILE" or "PC"))

-- ==================== CACHE SEGURO ====================
local function getService()
    local success, result = pcall(function()
        return RS:WaitForChild("Knit", 5):WaitForChild("Knit", 5):WaitForChild("Services", 5):WaitForChild("TodoService", 5):WaitForChild("RE", 5)
    end)
    
    if success then
        return result
    else
        warn("‚ö†Ô∏è N√£o foi poss√≠vel encontrar TodoService")
        return nil
    end
end

local todoService = getService()

if not todoService then
    warn("‚ùå Script n√£o pode iniciar - TodoService n√£o encontrado")
    return
end

-- ==================== FUN√á√ÉO PARA DETECTAR RAGDOLL DO TARGET ====================
local function isTargetRagdolled(target)
    if not target then return false end
    
    local humanoid = target:FindFirstChild("Humanoid")
    if not humanoid then return false end
    
    -- Verificar se o target est√° em ragdoll (m√∫ltiplas verifica√ß√µes)
    local ragdolled = false
    
    -- M√©todo 1: PlatformStand
    if humanoid.PlatformStand then
        ragdolled = true
    end
    
    -- M√©todo 2: Sit (algumas vezes usado em ragdoll)
    if humanoid.Sit then
        ragdolled = true
    end
    
    -- M√©todo 3: Verificar se a HumanoidRootPart tem BallSocketConstraint (comum em ragdoll)
    local hrp = target:FindFirstChild("HumanoidRootPart")
    if hrp then
        for _, child in pairs(hrp:GetChildren()) do
            if child:IsA("BallSocketConstraint") or child:IsA("RagdollConstraint") then
                ragdolled = true
                break
            end
        end
    end
    
    return ragdolled
end

-- ==================== CRIAR GUI ====================
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "PerfectSwapGUI"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

pcall(function()
    if gethui then
        screenGui.Parent = gethui()
    elseif syn and syn.protect_gui then
        syn.protect_gui(screenGui)
        screenGui.Parent = game:GetService("CoreGui")
    else
        screenGui.Parent = game:GetService("CoreGui")
    end
end)

if not screenGui.Parent then
    screenGui.Parent = player:WaitForChild("PlayerGui")
end

-- ==================== BOT√ÉO PRINCIPAL ====================
local mainButton = Instance.new("TextButton")
mainButton.Name = "SwapButton"
mainButton.Size = UDim2.new(0, 85, 0, 85)
mainButton.Position = UDim2.new(0.88, 0, 0.7, 0)
mainButton.BackgroundTransparency = 1
mainButton.BorderSizePixel = 0
mainButton.Text = "üîÑ"
mainButton.TextColor3 = Color3.fromRGB(100, 200, 255)
mainButton.TextSize = 45
mainButton.Font = Enum.Font.GothamBold
mainButton.Active = true
mainButton.ZIndex = 2
mainButton.Visible = isMobile -- S√≥ vis√≠vel no mobile
mainButton.Parent = screenGui

local btnStroke = Instance.new("UIStroke")
btnStroke.Color = Color3.fromRGB(100, 200, 255)
btnStroke.Thickness = 4
btnStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
btnStroke.Parent = mainButton

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(1, 0)
btnCorner.Parent = mainButton

-- ==================== BOT√ÉO DE CADEADO ====================
local lockButton = Instance.new("TextButton")
lockButton.Name = "LockButton"
lockButton.Size = UDim2.new(0, 45, 0, 45)
lockButton.Position = UDim2.new(0, 0, 0, 0)
lockButton.BackgroundTransparency = 1
lockButton.BorderSizePixel = 0
lockButton.Text = "üîì"
lockButton.TextColor3 = Color3.fromRGB(200, 200, 200)
lockButton.TextSize = 22
lockButton.Font = Enum.Font.GothamBold
lockButton.ZIndex = 3
lockButton.Visible = isMobile -- S√≥ vis√≠vel no mobile
lockButton.Parent = screenGui

local lockStroke = Instance.new("UIStroke")
lockStroke.Color = Color3.fromRGB(150, 150, 150)
lockStroke.Thickness = 3
lockStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
lockStroke.Parent = lockButton

local lockCorner = Instance.new("UICorner")
lockCorner.CornerRadius = UDim.new(1, 0)
lockCorner.Parent = lockButton

-- ==================== PAINEL DE CONFIG ====================
local configPanel = Instance.new("Frame")
configPanel.Size = UDim2.new(0, 240, 0, isPC and 310 or 250) -- Maior se for PC (para keybind)
configPanel.Position = UDim2.new(0.5, -120, 0.5, isPC and -155 or -125)
configPanel.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
configPanel.BorderSizePixel = 0
configPanel.Visible = false
configPanel.ZIndex = 15
configPanel.Parent = screenGui

local cfgCorner = Instance.new("UICorner")
cfgCorner.CornerRadius = UDim.new(0, 12)
cfgCorner.Parent = configPanel

local cfgStroke = Instance.new("UIStroke")
cfgStroke.Color = Color3.fromRGB(100, 200, 255)
cfgStroke.Thickness = 2
cfgStroke.Parent = configPanel

-- T√≠tulo
local cfgTitle = Instance.new("TextLabel")
cfgTitle.Size = UDim2.new(1, 0, 0, 35)
cfgTitle.BackgroundTransparency = 1
cfgTitle.Text = "‚öôÔ∏è CONFIGURA√á√ïES"
cfgTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
cfgTitle.TextSize = 14
cfgTitle.Font = Enum.Font.GothamBold
cfgTitle.ZIndex = 16
cfgTitle.Parent = configPanel

-- Target Mode
local targetLabel = Instance.new("TextLabel")
targetLabel.Size = UDim2.new(1, -20, 0, 20)
targetLabel.Position = UDim2.new(0, 10, 0, 45)
targetLabel.BackgroundTransparency = 1
targetLabel.Text = "Modo de Target:"
targetLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
targetLabel.TextSize = 12
targetLabel.Font = Enum.Font.Gotham
targetLabel.TextXAlignment = Enum.TextXAlignment.Left
targetLabel.ZIndex = 16
targetLabel.Parent = configPanel

-- Bot√µes de modo
local dummyBtn = Instance.new("TextButton")
dummyBtn.Size = UDim2.new(0.45, -7.5, 0, 30)
dummyBtn.Position = UDim2.new(0, 10, 0, 70)
dummyBtn.BackgroundColor3 = Color3.fromRGB(100, 200, 255)
dummyBtn.BorderSizePixel = 0
dummyBtn.Text = "DUMMY"
dummyBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
dummyBtn.TextSize = 12
dummyBtn.Font = Enum.Font.GothamBold
dummyBtn.ZIndex = 16
dummyBtn.Parent = configPanel

local dummyCorner = Instance.new("UICorner")
dummyCorner.CornerRadius = UDim.new(0, 6)
dummyCorner.Parent = dummyBtn

local nearestBtn = Instance.new("TextButton")
nearestBtn.Size = UDim2.new(0.45, -7.5, 0, 30)
nearestBtn.Position = UDim2.new(0.55, 5, 0, 70)
nearestBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
nearestBtn.BorderSizePixel = 0
nearestBtn.Text = "PR√ìXIMO"
nearestBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
nearestBtn.TextSize = 12
nearestBtn.Font = Enum.Font.GothamBold
nearestBtn.ZIndex = 16
nearestBtn.Parent = configPanel

local nearestCorner = Instance.new("UICorner")
nearestCorner.CornerRadius = UDim.new(0, 6)
nearestCorner.Parent = nearestBtn

-- Delays
local delayLabel1 = Instance.new("TextLabel")
delayLabel1.Size = UDim2.new(1, -20, 0, 20)
delayLabel1.Position = UDim2.new(0, 10, 0, 115)
delayLabel1.BackgroundTransparency = 1
delayLabel1.Text = "Delay em p√© (s):"
delayLabel1.TextColor3 = Color3.fromRGB(200, 200, 200)
delayLabel1.TextSize = 11
delayLabel1.Font = Enum.Font.Gotham
delayLabel1.TextXAlignment = Enum.TextXAlignment.Left
delayLabel1.ZIndex = 16
delayLabel1.Parent = configPanel

local standingInput = Instance.new("TextBox")
standingInput.Size = UDim2.new(0, 80, 0, 26)
standingInput.Position = UDim2.new(0, 10, 0, 138)
standingInput.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
standingInput.BorderSizePixel = 0
standingInput.Text = tostring(CONFIG.delayStanding)
standingInput.TextColor3 = Color3.fromRGB(255, 255, 255)
standingInput.TextSize = 13
standingInput.Font = Enum.Font.Gotham
standingInput.PlaceholderText = "0.5"
standingInput.ZIndex = 16
standingInput.Parent = configPanel

local standingCorner = Instance.new("UICorner")
standingCorner.CornerRadius = UDim.new(0, 6)
standingCorner.Parent = standingInput

local standingStroke = Instance.new("UIStroke")
standingStroke.Color = Color3.fromRGB(100, 200, 255)
standingStroke.Thickness = 1
standingStroke.Parent = standingInput

local delayLabel2 = Instance.new("TextLabel")
delayLabel2.Size = UDim2.new(1, -20, 0, 20)
delayLabel2.Position = UDim2.new(0, 10, 0, 173)
delayLabel2.BackgroundTransparency = 1
delayLabel2.Text = "Delay ragdoll (s):"
delayLabel2.TextColor3 = Color3.fromRGB(200, 200, 200)
delayLabel2.TextSize = 11
delayLabel2.Font = Enum.Font.Gotham
delayLabel2.TextXAlignment = Enum.TextXAlignment.Left
delayLabel2.ZIndex = 16
delayLabel2.Parent = configPanel

local ragdollInput = Instance.new("TextBox")
ragdollInput.Size = UDim2.new(0, 80, 0, 26)
ragdollInput.Position = UDim2.new(0, 10, 0, 196)
ragdollInput.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
ragdollInput.BorderSizePixel = 0
ragdollInput.Text = tostring(CONFIG.delayRagdoll)
ragdollInput.TextColor3 = Color3.fromRGB(255, 255, 255)
ragdollInput.TextSize = 13
ragdollInput.Font = Enum.Font.Gotham
ragdollInput.PlaceholderText = "0.3"
ragdollInput.ZIndex = 16
ragdollInput.Parent = configPanel

local ragdollCorner = Instance.new("UICorner")
ragdollCorner.CornerRadius = UDim.new(0, 6)
ragdollCorner.Parent = ragdollInput

local ragdollStroke = Instance.new("UIStroke")
ragdollStroke.Color = Color3.fromRGB(255, 100, 100)
ragdollStroke.Thickness = 1
ragdollStroke.Parent = ragdollInput

-- Keybind (s√≥ para PC)
local keybindLabel, keybindButton, currentKeyText

if isPC then
    keybindLabel = Instance.new("TextLabel")
    keybindLabel.Size = UDim2.new(1, -20, 0, 20)
    keybindLabel.Position = UDim2.new(0, 10, 0, 231)
    keybindLabel.BackgroundTransparency = 1
    keybindLabel.Text = "Keybind:"
    keybindLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    keybindLabel.TextSize = 11
    keybindLabel.Font = Enum.Font.Gotham
    keybindLabel.TextXAlignment = Enum.TextXAlignment.Left
    keybindLabel.ZIndex = 16
    keybindLabel.Parent = configPanel
    
    keybindButton = Instance.new("TextButton")
    keybindButton.Size = UDim2.new(0, 200, 0, 28)
    keybindButton.Position = UDim2.new(0, 10, 0, 254)
    keybindButton.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    keybindButton.BorderSizePixel = 0
    keybindButton.Text = "[ " .. CONFIG.hotkey.Name .. " ]"
    keybindButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    keybindButton.TextSize = 13
    keybindButton.Font = Enum.Font.GothamBold
    keybindButton.ZIndex = 16
    keybindButton.Parent = configPanel
    
    local keybindCorner = Instance.new("UICorner")
    keybindCorner.CornerRadius = UDim.new(0, 6)
    keybindCorner.Parent = keybindButton
    
    local keybindStroke = Instance.new("UIStroke")
    keybindStroke.Color = Color3.fromRGB(255, 200, 100)
    keybindStroke.Thickness = 1
    keybindStroke.Parent = keybindButton
    
    currentKeyText = keybindButton
end

-- Bot√£o Salvar
local saveBtn = Instance.new("TextButton")
saveBtn.Size = UDim2.new(0, 120, 0, 28)
saveBtn.Position = UDim2.new(0, 110, 0, isPC and 194 or 138)
saveBtn.BackgroundColor3 = Color3.fromRGB(76, 175, 80)
saveBtn.BorderSizePixel = 0
saveBtn.Text = "‚úì SALVAR"
saveBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
saveBtn.TextSize = 13
saveBtn.Font = Enum.Font.GothamBold
saveBtn.ZIndex = 16
saveBtn.Parent = configPanel

local saveCorner = Instance.new("UICorner")
saveCorner.CornerRadius = UDim.new(0, 6)
saveCorner.Parent = saveBtn

-- Bot√£o Fechar
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 120, 0, 28)
closeBtn.Position = UDim2.new(0, 110, 0, isPC and 250 or 194)
closeBtn.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
closeBtn.BorderSizePixel = 0
closeBtn.Text = "‚úó FECHAR"
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.TextSize = 13
closeBtn.Font = Enum.Font.GothamBold
closeBtn.ZIndex = 16
closeBtn.Parent = configPanel

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 6)
closeCorner.Parent = closeBtn

-- ==================== BOT√ÉO DE CONFIG ====================
local configBtn = Instance.new("TextButton")
configBtn.Size = UDim2.new(0, 45, 0, 45)
configBtn.Position = UDim2.new(1, -55, 0, 10)
configBtn.BackgroundTransparency = 1
configBtn.BorderSizePixel = 0
configBtn.Text = "‚öôÔ∏è"
configBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
configBtn.TextSize = 22
configBtn.Font = Enum.Font.GothamBold
configBtn.ZIndex = 5
configBtn.Parent = screenGui

local cfgBtnStroke = Instance.new("UIStroke")
cfgBtnStroke.Color = Color3.fromRGB(150, 150, 150)
cfgBtnStroke.Thickness = 3
cfgBtnStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
cfgBtnStroke.Parent = configBtn

local cfgBtnCorner = Instance.new("UICorner")
cfgBtnCorner.CornerRadius = UDim.new(1, 0)
cfgBtnCorner.Parent = configBtn

-- ==================== FUN√á√ïES ====================
local function getNearestPlayer()
    local char = player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return nil end
    
    local myPos = char.HumanoidRootPart.Position
    local nearest = nil
    local minDist = math.huge
    
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= player then
            local c = p.Character
            if c and c:FindFirstChild("HumanoidRootPart") then
                local dist = (c.HumanoidRootPart.Position - myPos).Magnitude
                if dist < minDist then
                    minDist = dist
                    nearest = c
                end
            end
        end
    end
    
    return nearest
end

local function executePerfectSwap()
    if isExecuting or not todoService then return end
    isExecuting = true
    
    if isMobile then
        mainButton.TextColor3 = Color3.fromRGB(100, 200, 255)
        btnStroke.Color = isLocked and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(100, 200, 255)
    end
    
    -- Passo 1: Target
    local target = nil
    local success1 = pcall(function()
        if CONFIG.targetMode == "dummy" then
            target = workspace:FindFirstChild("Characters") and workspace.Characters:FindFirstChild("Dummy")
        elseif CONFIG.targetMode == "nearest" then
            target = getNearestPlayer()
        end
        
        if target then
            todoService.RightActivated:FireServer(target)
        else
            warn("‚ö†Ô∏è Target n√£o encontrado")
            todoService.RightActivated:FireServer()
        end
    end)
    
    if not success1 then
        warn("‚ùå Erro no Swap - Passo 1")
        if isMobile then
            mainButton.TextColor3 = Color3.fromRGB(255, 50, 50)
            task.wait(1)
            mainButton.TextColor3 = Color3.fromRGB(100, 200, 255)
            btnStroke.Color = isLocked and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(100, 200, 255)
        end
        isExecuting = false
        return
    end
    
    -- Detectar se o TARGET est√° em ragdoll e usar delay apropriado
    local targetInRagdoll = isTargetRagdolled(target)
    local currentDelay = targetInRagdoll and CONFIG.delayRagdoll or CONFIG.delayStanding
    
    if targetInRagdoll then
        print("üî¥ Target em ragdoll! Usando delay: " .. currentDelay .. "s")
    else
        print("üü¢ Target em p√©! Usando delay: " .. currentDelay .. "s")
    end
    
    task.wait(currentDelay)
    
    -- Passo 2: Soco
    if isMobile then
        mainButton.TextColor3 = Color3.fromRGB(255, 100, 255)
    end
    
    local success2 = pcall(function()
        todoService.Activated:FireServer(false)
    end)
    
    if not success2 then
        warn("‚ùå Erro no Swap - Passo 2")
    end
    
    if isMobile then
        mainButton.TextColor3 = Color3.fromRGB(100, 255, 100)
        
        task.wait(0.5)
        mainButton.TextColor3 = Color3.fromRGB(100, 200, 255)
        btnStroke.Color = isLocked and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(100, 200, 255)
    end
    
    isExecuting = false
end

local function toggleLock()
    isLocked = not isLocked
    
    if isLocked then
        lockButton.Text = "üîí"
        lockButton.TextColor3 = Color3.fromRGB(100, 255, 100)
        lockStroke.Color = Color3.fromRGB(0, 255, 0)
        btnStroke.Color = Color3.fromRGB(0, 255, 0)
    else
        lockButton.Text = "üîì"
        lockButton.TextColor3 = Color3.fromRGB(200, 200, 200)
        lockStroke.Color = Color3.fromRGB(150, 150, 150)
        btnStroke.Color = Color3.fromRGB(100, 200, 255)
    end
end

-- ==================== SISTEMA DE DRAG (APENAS MOBILE) ====================
if isMobile then
    mainButton.InputBegan:Connect(function(input)
        if (input.UserInputType == Enum.UserInputType.MouseButton1 or 
            input.UserInputType == Enum.UserInputType.Touch) and not isLocked then
            
            isDragging = true
            dragStart = input.Position
            startPos = mainButton.Position
            
            local connection
            connection = input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    isDragging = false
                    connection:Disconnect()
                end
            end)
        end
    end)

    UIS.InputChanged:Connect(function(input)
        if isDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or 
           input.UserInputType == Enum.UserInputType.Touch) then
            
            local delta = input.Position - dragStart
            mainButton.Position = UDim2.new(
                startPos.X.Scale, startPos.X.Offset + delta.X,
                startPos.Y.Scale, startPos.Y.Offset + delta.Y
            )
        end
    end)

    -- Executar apenas se n√£o arrastou
    local clickTime = 0
    mainButton.MouseButton1Click:Connect(function()
        local currentTime = tick()
        if not isDragging and (currentTime - clickTime) > 0.3 then
            clickTime = currentTime
            executePerfectSwap()
        end
    end)

    lockButton.MouseButton1Click:Connect(toggleLock)
end

dummyBtn.MouseButton1Click:Connect(function()
    CONFIG.targetMode = "dummy"
    dummyBtn.BackgroundColor3 = Color3.fromRGB(100, 200, 255)
    nearestBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    print("üéØ Modo: DUMMY")
end)

nearestBtn.MouseButton1Click:Connect(function()
    CONFIG.targetMode = "nearest"
    dummyBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    nearestBtn.BackgroundColor3 = Color3.fromRGB(100, 200, 255)
    print("üéØ Modo: PR√ìXIMO")
end)

saveBtn.MouseButton1Click:Connect(function()
    local standing = tonumber(standingInput.Text)
    local ragdoll = tonumber(ragdollInput.Text)
    
    if standing and standing >= 0 and standing <= 5 and ragdoll and ragdoll >= 0 and ragdoll <= 5 then
        CONFIG.delayStanding = standing
        CONFIG.delayRagdoll = ragdoll
        
        saveBtn.BackgroundColor3 = Color3.fromRGB(100, 255, 100)
        saveBtn.Text = "‚úì SALVO!"
        
        task.wait(0.5)
        saveBtn.BackgroundColor3 = Color3.fromRGB(76, 175, 80)
        saveBtn.Text = "‚úì SALVAR"
        
        print("‚öôÔ∏è Delays salvos!")
        print("üü¢ Em p√©: " .. CONFIG.delayStanding .. "s")
        print("üî¥ Ragdoll: " .. CONFIG.delayRagdoll .. "s")
    else
        saveBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
        saveBtn.Text = "‚úó INV√ÅLIDO"
        
        task.wait(1)
        saveBtn.BackgroundColor3 = Color3.fromRGB(76, 175, 80)
        saveBtn.Text = "‚úì SALVAR"
        
        standingInput.Text = tostring(CONFIG.delayStanding)
        ragdollInput.Text = tostring(CONFIG.delayRagdoll)
    end
end)

closeBtn.MouseButton1Click:Connect(function()
    configPanel.Visible = false
    configBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
    cfgBtnStroke.Color = Color3.fromRGB(150, 150, 150)
end)

standingInput.FocusLost:Connect(function()
    local value = tonumber(standingInput.Text)
    if not value or value < 0 or value > 5 then
        standingInput.Text = tostring(CONFIG.delayStanding)
    end
end)

ragdollInput.FocusLost:Connect(function()
    local value = tonumber(ragdollInput.Text)
    if not value or value < 0 or value > 5 then
        ragdollInput.Text = tostring(CONFIG.delayRagdoll)
    end
end)

configBtn.MouseButton1Click:Connect(function()
    configPanel.Visible = not configPanel.Visible
    
    if configPanel.Visible then
        configBtn.TextColor3 = Color3.fromRGB(100, 200, 255)
        cfgBtnStroke.Color = Color3.fromRGB(100, 200, 255)
    else
        configBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
        cfgBtnStroke.Color = Color3.fromRGB(150, 150, 150)
    end
end)

-- ==================== API ====================
_G.PerfectSwap = {
    Execute = executePerfectSwap,
    SetMode = function(mode)
        if mode == "dummy" or mode == "nearest" then
            CONFIG.targetMode = mode
            return true
        end
        return false
    end,
    SetDelay = function(standing, ragdoll)
        if standing >= 0 and standing <= 5 and ragdoll >= 0 and ragdoll <= 5 then
            CONFIG.delayStanding = standing
            CONFIG.delayRagdoll = ragdoll
            standingInput.Text = tostring(standing)
            ragdollInput.Text = tostring(ragdoll)
            return true
        end
        return false
    end,
    ToggleLock = toggleLock,
    Destroy = function()
        screenGui:Destroy()
    end
}

print("‚úÖ Perfect Swap com Auto-Delay carregado!")
print("üì± Plataforma: " .. (isMobile and "MOBILE" or "PC"))
if isPC then
    print("‚å®Ô∏è Keybind atual: [" .. CONFIG.hotkey.Name .. "]")
else
    print("üîÑ Clique no bot√£o azul para executar")
end
print("üü¢ Target em p√©: " .. CONFIG.delayStanding .. "s")
print("üî¥ Target ragdoll: " .. CONFIG.delayRagdoll .. "s")
print("‚öôÔ∏è Abra config para ajustar")
