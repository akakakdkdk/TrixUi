-- // CONFIGURAÇÃO INICIAL
getgenv().FocusEnabled = true 

local ReplicatedStorage = game:GetService('ReplicatedStorage')
local focusRemote = ReplicatedStorage:WaitForChild('Knit'):WaitForChild('Knit'):WaitForChild('Services'):WaitForChild('FocusStrikeService'):WaitForChild('RE'):WaitForChild('Activated')

local scriptDisparando = false 

-- // LÓGICA DO SEGUNDO HIT
local function DispararSegundoHit(habilidadeObj)
    -- Verifica o toggle antes de esperar e antes de atirar
    if not getgenv().FocusEnabled then return end
    
    task.wait(0.33)
    
    if getgenv().FocusEnabled then
        scriptDisparando = true 
        focusRemote:FireServer(habilidadeObj)
        task.wait(0.1) 
        scriptDisparando = false 
    end
end

-- // O GATILHO (Monitora o clique)
local oldNamecall
oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
    local method = getnamecallmethod()
    local args = {...}

    -- O Toggle 'FocusEnabled' controla se o hook deve ou não agir
    if getgenv().FocusEnabled and self == focusRemote and method == "FireServer" and not scriptDisparando then
        if args[1] then
            task.spawn(function()
                DispararSegundoHit(args[1])
            end)
        end
    end

    return oldNamecall(self, ...)
end)

print("Focus Strike com Toggle carregado! Use getgenv().FocusEnabled para ligar/desligar.")
